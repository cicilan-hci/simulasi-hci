<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Kalkulator Cicilan</title>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #ffffff;
    --surface: #fff5f5;
    --surface2: #ffe5e5;
    --border: #ffcccc;
    --accent: #dc2626;
    --accent2: #ef4444;
    --accent3: #991b1b;
    --text: #1a1a1a;
    --muted: #6b7280;
    --danger: #b91c1c;
    --card-radius: 20px;
    --font: 'Plus Jakarta Sans', sans-serif;
    --mono: 'JetBrains Mono', monospace;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  body {
    background: var(--bg);
    font-family: var(--font);
    color: var(--text);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 0;
  }

  .app {
    width: 100%;
    max-width: 430px;
    min-height: 100vh;
    background: var(--bg);
    position: relative;
    overflow: hidden;
  }

  /* HEADER */
  .header {
    background: linear-gradient(135deg, #fee2e2 0%, #ffffff 100%);
    padding: 54px 24px 28px;
    position: relative;
    border-bottom: 1px solid var(--border);
  }
  .header::before {
    content: '';
    position: absolute;
    top: -40px; right: -40px;
    width: 160px; height: 160px;
    background: radial-gradient(circle, rgba(220,38,38,0.15) 0%, transparent 70%);
    border-radius: 50%;
  }
  .header-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: rgba(220,38,38,0.12);
    border: 1px solid rgba(220,38,38,0.25);
    color: var(--accent);
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    padding: 4px 10px;
    border-radius: 20px;
    margin-bottom: 10px;
  }
  .header h1 {
    font-size: 26px;
    font-weight: 800;
    letter-spacing: -0.5px;
    line-height: 1.2;
  }
  .header p {
    color: var(--muted);
    font-size: 13px;
    margin-top: 6px;
    font-weight: 500;
  }

  /* PROGRESS */
  .progress-wrap {
    padding: 18px 24px 0;
  }
  .progress-steps {
    display: flex;
    align-items: center;
    gap: 0;
  }
  .step-dot {
    width: 28px; height: 28px;
    border-radius: 50%;
    background: var(--surface2);
    border: 2px solid var(--border);
    display: flex; align-items: center; justify-content: center;
    font-size: 11px; font-weight: 700; color: var(--muted);
    transition: all 0.3s ease;
    flex-shrink: 0;
    position: relative;
    z-index: 1;
  }
  .step-dot.active {
    background: var(--accent);
    border-color: var(--accent);
    color: white;
    box-shadow: 0 0 14px rgba(220,38,38,0.4);
  }
  .step-dot.done {
    background: var(--accent2);
    border-color: var(--accent2);
    color: white;
  }
  .step-dot.done::after {
    content: '‚úì';
    font-size: 12px;
  }
  .step-dot.done span { display: none; }
  .step-line {
    flex: 1;
    height: 2px;
    background: var(--border);
    transition: background 0.3s ease;
  }
  .step-line.done { background: var(--accent2); }
  .step-labels {
    display: flex;
    justify-content: space-between;
    margin-top: 6px;
    padding: 0 0px;
  }
  .step-label {
    font-size: 10px;
    color: var(--muted);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    width: 28px;
    text-align: center;
  }
  .step-label.active { color: var(--accent); }

  /* CONTENT */
  .content {
    padding: 20px 24px 100px;
  }

  /* CARD */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--card-radius);
    padding: 20px;
    margin-bottom: 14px;
    animation: slideUp 0.35s ease;
  }
  @keyframes slideUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .card-title {
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--muted);
    margin-bottom: 14px;
  }

  /* INPUT NOMINAL */
  .nominal-display {
    font-family: var(--mono);
    font-size: 32px;
    font-weight: 500;
    color: var(--text);
    letter-spacing: -1px;
    min-height: 44px;
    padding: 10px 0 4px;
    border-bottom: 2px solid var(--accent);
    margin-bottom: 16px;
    cursor: text;
    transition: border-color 0.2s;
  }
  .nominal-display.empty { color: var(--muted); font-size: 22px; }
  .nominal-display:focus { outline: none; border-color: var(--accent2); }

  /* NUMPAD */
  .numpad {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
  }
  .numpad-btn {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 14px;
    height: 54px;
    font-family: var(--mono);
    font-size: 18px;
    font-weight: 500;
    color: var(--text);
    cursor: pointer;
    transition: all 0.15s ease;
    display: flex; align-items: center; justify-content: center;
    -webkit-user-select: none; user-select: none;
  }
  .numpad-btn:active { transform: scale(0.93); background: var(--border); }
  .numpad-btn.zero { grid-column: span 2; }
  .numpad-btn.del {
    color: var(--danger);
    font-size: 22px;
  }
  .numpad-btn.next-btn {
    grid-column: span 3;
    background: var(--accent);
    border-color: var(--accent);
    color: white;
    font-family: var(--font);
    font-size: 15px;
    font-weight: 700;
    height: 52px;
    border-radius: 16px;
    letter-spacing: 0.02em;
    margin-top: 6px;
  }
  .numpad-btn.next-btn:active { transform: scale(0.97); background: #b91c1c; }

  /* TOGGLE BUTTONS */
  .toggle-grid {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }
  .toggle-btn {
    display: flex;
    align-items: center;
    gap: 14px;
    background: var(--surface2);
    border: 1.5px solid var(--border);
    border-radius: 16px;
    padding: 14px 16px;
    cursor: pointer;
    transition: all 0.2s ease;
    -webkit-user-select: none; user-select: none;
  }
  .toggle-btn.selected {
    border-color: var(--accent2);
    background: rgba(239,68,68,0.07);
  }
  .toggle-btn.selected .toggle-check {
    background: var(--accent2);
    border-color: var(--accent2);
  }
  .toggle-btn.selected .toggle-check::after { opacity: 1; }
  .toggle-check {
    width: 22px; height: 22px;
    border-radius: 8px;
    border: 2px solid var(--border);
    background: var(--surface);
    flex-shrink: 0;
    transition: all 0.2s;
    position: relative;
    display: flex; align-items: center; justify-content: center;
  }
  .toggle-check::after {
    content: '‚úì';
    color: white;
    font-size: 13px;
    font-weight: 800;
    opacity: 0;
    transition: opacity 0.2s;
  }
  .toggle-info { flex: 1; }
  .toggle-name {
    font-size: 14px;
    font-weight: 700;
    color: var(--text);
  }
  .toggle-desc {
    font-size: 12px;
    color: var(--muted);
    margin-top: 2px;
  }
  .toggle-price {
    font-family: var(--mono);
    font-size: 13px;
    color: var(--accent3);
    font-weight: 500;
    text-align: right;
    flex-shrink: 0;
  }

  /* PROTEKSI YN */
  .yn-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
  }
  .yn-btn {
    background: var(--surface2);
    border: 1.5px solid var(--border);
    border-radius: 16px;
    padding: 18px 10px;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s ease;
    -webkit-user-select: none; user-select: none;
  }
  .yn-btn:active { transform: scale(0.95); }
  .yn-btn.yn-yes { border-color: var(--accent2); background: rgba(239,68,68,0.07); }
  .yn-btn.yn-no { border-color: var(--border); }
  .yn-icon { font-size: 28px; margin-bottom: 6px; }
  .yn-label { font-size: 13px; font-weight: 700; }
  .yn-sub { font-size: 11px; color: var(--muted); margin-top: 3px; }

  /* BUNGA GRID */
  .bunga-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
  }
  .bunga-btn {
    background: var(--surface2);
    border: 1.5px solid var(--border);
    border-radius: 14px;
    padding: 12px 8px;
    cursor: pointer;
    text-align: center;
    transition: all 0.2s ease;
    -webkit-user-select: none; user-select: none;
  }
  .bunga-btn:active { transform: scale(0.94); }
  .bunga-btn.selected {
    border-color: var(--accent);
    background: rgba(220,38,38,0.1);
  }
  .bunga-rate {
    font-family: var(--mono);
    font-size: 16px;
    font-weight: 500;
    color: var(--text);
  }
  .bunga-label { font-size: 10px; color: var(--muted); margin-top: 2px; font-weight: 600; }

  /* RESULT */
  .result-header {
    background: linear-gradient(135deg, rgba(220,38,38,0.15), rgba(239,68,68,0.08));
    border: 1px solid rgba(220,38,38,0.2);
    border-radius: var(--card-radius);
    padding: 18px 20px;
    margin-bottom: 14px;
  }
  .result-header-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }
  .result-header-row:last-child { margin-bottom: 0; }
  .result-label { font-size: 12px; color: var(--muted); font-weight: 600; }
  .result-value {
    font-family: var(--mono);
    font-size: 14px;
    font-weight: 500;
    color: var(--text);
  }
  .result-value.big {
    font-size: 22px;
    color: var(--accent2);
    letter-spacing: -0.5px;
  }

  /* TENOR CARD */
  .tenor-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--card-radius);
    overflow: hidden;
    margin-bottom: 14px;
  }
  .tenor-header {
    background: var(--surface2);
    padding: 12px 18px;
    display: flex;
    align-items: center;
    gap: 10px;
    border-bottom: 1px solid var(--border);
    cursor: pointer;
    user-select: none;
    -webkit-user-select: none;
  }
  .tenor-badge {
    background: rgba(220,38,38,0.15);
    color: var(--accent);
    font-size: 12px;
    font-weight: 800;
    padding: 3px 10px;
    border-radius: 8px;
    font-family: var(--mono);
    letter-spacing: 0.03em;
  }
  .tenor-title { font-size: 14px; font-weight: 700; color: var(--text); }
  .option-row {
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 13px 15px;
    margin-bottom: 10px;
    position: relative;
    overflow: hidden;
  }
  .option-row:last-child { margin-bottom: 0; }
  .option-row.promo {
    border-color: rgba(239,68,68,0.3);
    background: rgba(239,68,68,0.04);
  }
  .option-label {
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.06em;
    color: var(--muted);
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .promo-tag {
    background: rgba(239,68,68,0.15);
    color: var(--accent2);
    font-size: 10px;
    padding: 2px 7px;
    border-radius: 6px;
    font-weight: 700;
  }
  .option-cicilan {
    font-family: var(--mono);
    font-size: 22px;
    font-weight: 500;
    color: var(--text);
    letter-spacing: -0.5px;
  }
  .option-total {
    font-size: 12px;
    color: var(--muted);
    margin-top: 4px;
    font-family: var(--mono);
  }
  .option-warn {
    font-size: 11px;
    color: var(--danger);
    margin-top: 5px;
    display: flex;
    align-items: center;
    gap: 4px;
    opacity: 0.8;
  }

  /* PROMO SPESIAL SECTION */
  .promo-spesial-wrap {
    margin-top: 10px;
    border-top: 1px dashed rgba(245,158,11,0.25);
    padding-top: 10px;
  }
  .promo-spesial-title {
    font-size: 10px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--accent3);
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 5px;
  }
  .promo-spesial-card {
    border-radius: 12px;
    padding: 11px 13px;
    margin-bottom: 8px;
  }
  .promo-spesial-card:last-child { margin-bottom: 0; }
  .promo-s1 {
    background: rgba(245,158,11,0.07);
    border: 1px solid rgba(245,158,11,0.25);
  }
  .promo-s2 {
    background: rgba(79,142,247,0.07);
    border: 1px solid rgba(79,142,247,0.25);
  }
  .promo-sp-label {
    font-size: 11px;
    font-weight: 700;
    color: var(--accent3);
    margin-bottom: 3px;
  }
  .promo-s2 .promo-sp-label { color: var(--accent); }
  .promo-sp-cicilan {
    font-family: var(--mono);
    font-size: 18px;
    font-weight: 500;
    color: var(--text);
  }
  .promo-sp-detail {
    font-size: 11px;
    color: var(--muted);
    margin-top: 3px;
    line-height: 1.5;
  }
  .promo-sp-toko {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 5px;
  }
  .toko-tag {
    background: rgba(79,142,247,0.12);
    border: 1px solid rgba(79,142,247,0.2);
    color: var(--accent);
    font-size: 10px;
    font-weight: 700;
    padding: 2px 7px;
    border-radius: 6px;
  }

  .proteksi-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 4px;
  }
  .ptag-wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3px;
  }
  .ptag {
    background: rgba(239,68,68,0.1);
    border: 1px solid rgba(239,68,68,0.25);
    color: var(--accent2);
    font-size: 11px;
    font-weight: 700;
    padding: 3px 9px;
    border-radius: 8px;
  }
  .ptag-price {
    font-family: var(--mono);
    font-size: 10px;
    color: var(--accent3);
    font-weight: 600;
    letter-spacing: 0.01em;
  }
  /* TENOR COLLAPSIBLE */
  .tenor-header {
    cursor: pointer;
    user-select: none;
    -webkit-user-select: none;
  }
  .tenor-header:active { opacity: 0.8; }
  .tenor-toggle-icon {
    margin-left: auto;
    width: 26px;
    height: 26px;
    border-radius: 8px;
    background: rgba(220,38,38,0.12);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    color: var(--accent);
    transition: transform 0.3s ease;
    flex-shrink: 0;
  }
  .tenor-toggle-icon.open {
    transform: rotate(180deg);
    background: rgba(239,68,68,0.12);
    color: var(--accent2);
  }
  .tenor-body {
    padding: 16px 18px;
    display: none;
    animation: slideDown 0.3s ease;
  }
  .tenor-body.open {
    display: block;
  }
  @keyframes slideDown {
    from { opacity: 0; transform: translateY(-8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* PROMO TOTAL SETELAH DISKON */
  .promo-sp-total {
    font-size: 11px;
    color: var(--accent3);
    font-family: var(--mono);
    margin-top: 4px;
    font-weight: 600;
  }
  .promo-s2 .promo-sp-total { color: var(--accent); }

  /* SECTION COLLAPSIBLE (inner) */
  .section-toggle {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 10px 14px;
    border-radius: 12px;
    cursor: pointer;
    margin-bottom: 6px;
    transition: background 0.2s;
    -webkit-user-select: none; user-select: none;
  }
  .section-toggle:active { opacity: 0.75; }
  .section-toggle.s-standard {
    background: rgba(124,132,158,0.08);
    border: 1px solid rgba(124,132,158,0.15);
  }
  .section-toggle.s-gratis {
    background: rgba(239,68,68,0.06);
    border: 1px solid rgba(239,68,68,0.2);
  }
  .section-toggle.s-diskon {
    background: rgba(245,158,11,0.06);
    border: 1px solid rgba(245,158,11,0.2);
  }
  .section-toggle-left {
    display: flex;
    align-items: center;
    gap: 7px;
  }
  .section-toggle-label {
    font-size: 12px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  .s-standard .section-toggle-label { color: var(--muted); }
  .s-gratis .section-toggle-label { color: var(--accent2); }
  .s-diskon .section-toggle-label { color: var(--accent3); }
  .section-toggle-cicilan {
    font-family: var(--mono);
    font-size: 13px;
    font-weight: 600;
    color: var(--text);
    opacity: 0.7;
  }
  .section-chevron {
    font-size: 11px;
    color: var(--muted);
    transition: transform 0.25s ease;
    flex-shrink: 0;
  }
  .section-chevron.open { transform: rotate(180deg); }
  .section-body {
    display: none;
    animation: slideDown 0.25s ease;
    margin-bottom: 8px;
  }
  .section-body.open { display: block; }

  /* SUB COLLAPSIBLE (toko khusus dalam gratis cicilan) */
  .sub-toggle {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 9px 12px;
    border-radius: 10px;
    cursor: pointer;
    margin-bottom: 5px;
    transition: all 0.2s;
    -webkit-user-select: none; user-select: none;
  }
  .sub-toggle:active { opacity: 0.75; }
  .sub-toggle.sub-reguler {
    background: rgba(239,68,68,0.05);
    border: 1px solid rgba(239,68,68,0.15);
  }
  .sub-toggle.sub-erafone {
    background: rgba(248,113,113,0.06);
    border: 1px solid rgba(248,113,113,0.2);
  }
  .sub-toggle.sub-ibox {
    background: rgba(79,142,247,0.06);
    border: 1px solid rgba(79,142,247,0.2);
  }
  .sub-toggle-label {
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .sub-reguler .sub-toggle-label { color: var(--accent2); }
  .sub-erafone .sub-toggle-label { color: var(--danger); }
  .sub-ibox .sub-toggle-label { color: var(--accent); }
  .sub-toggle-right {
    display: flex;
    align-items: center;
    gap: 7px;
  }
  .sub-toggle-cicilan {
    font-family: var(--mono);
    font-size: 12px;
    font-weight: 600;
    color: var(--text);
    opacity: 0.75;
  }
  .sub-chevron {
    font-size: 10px;
    color: var(--muted);
    transition: transform 0.25s ease;
    flex-shrink: 0;
  }
  .sub-chevron.open { transform: rotate(180deg); }
  .sub-body {
    display: none;
    animation: slideDown 0.2s ease;
    margin-bottom: 6px;
    padding: 4px 4px 2px;
  }
  .sub-body.open { display: block; }
  .sub-tag {
    display: inline-block;
    font-size: 10px;
    font-weight: 700;
    padding: 2px 8px;
    border-radius: 6px;
    margin-bottom: 6px;
  }
  .sub-tag.t-reguler { background: rgba(239,68,68,0.12); color: var(--accent2); }
  .sub-tag.t-erafone { background: rgba(248,113,113,0.12); color: var(--danger); }
  .sub-tag.t-ibox { background: rgba(79,142,247,0.12); color: var(--accent); }
  .sub-admin-note {
    font-size: 10px;
    color: var(--muted);
    margin-bottom: 6px;
    font-style: italic;
  }
  .calc-desc {
    background: rgba(255,255,255,0.03);
    border: 1px dashed rgba(255,255,255,0.08);
    border-radius: 8px;
    padding: 8px 10px;
    margin-top: 8px;
    font-size: 10px;
    color: var(--muted);
    line-height: 1.6;
  }
  .calc-desc code {
    font-family: var(--mono);
    font-size: 10px;
    color: var(--accent3);
    background: rgba(245,158,11,0.08);
    padding: 1px 4px;
    border-radius: 4px;
  }

  /* ACTIONS */
  .action-bar {
    position: fixed;
    bottom: 0; left: 50%;
    transform: translateX(-50%);
    width: 100%;
    max-width: 430px;
    padding: 12px 20px 24px;
    background: linear-gradient(to top, var(--bg) 70%, transparent);
    display: flex;
    gap: 10px;
  }
  .btn {
    flex: 1;
    height: 52px;
    border-radius: 16px;
    border: none;
    font-family: var(--font);
    font-size: 14px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex; align-items: center; justify-content: center; gap: 6px;
    -webkit-user-select: none; user-select: none;
  }
  .btn:active { transform: scale(0.96); }
  .btn-primary {
    background: var(--accent);
    color: white;
    box-shadow: 0 4px 20px rgba(220,38,38,0.3);
  }
  .btn-primary:active { background: #b91c1c; }
  .btn-secondary {
    background: var(--surface2);
    color: var(--text);
    border: 1px solid var(--border);
    flex: 0 0 52px;
  }
  .btn-ghost {
    background: transparent;
    color: var(--muted);
    border: 1px solid var(--border);
    font-size: 13px;
  }

  /* SCREEN MGMT */
  .screen { display: none; }
  .screen.active { display: block; }

  /* ASURANSI INFO */
  .info-chip {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    background: rgba(220,38,38,0.1);
    color: var(--accent);
    font-size: 11px;
    padding: 5px 10px;
    border-radius: 10px;
    margin-bottom: 14px;
    font-weight: 500;
  }

  /* SEPARATOR */
  .sep {
    height: 1px;
    background: var(--border);
    margin: 16px 0;
  }

  .fade { animation: fadeIn 0.3s ease; }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

  /* DARK SCROLLBAR */
  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }
</style>
</head>
<body>
<div class="app">

  <!-- HEADER -->
  <div class="header">
    <div class="header-badge">üí≥ Kredit</div>
    <h1>Simulasi Cicilan HCI</h1>
    <p>Simulasi masih perkiraan, bukan angka pasti.</p>
  </div>

  <!-- PROGRESS -->
  <div class="progress-wrap">
    <div class="progress-steps">
      <div class="step-dot active" id="dot1"><span>1</span></div>
      <div class="step-line" id="line1"></div>
      <div class="step-dot" id="dot2"><span>2</span></div>
      <div class="step-line" id="line2"></div>
      <div class="step-dot" id="dot3"><span>3</span></div>
      <div class="step-line" id="line3"></div>
      <div class="step-dot" id="dot4"><span>4</span></div>
    </div>
    <div class="step-labels">
      <div class="step-label active" id="lbl1">Input</div>
      <div class="step-label" style="width:auto;flex:1;text-align:center;"></div>
      <div class="step-label" id="lbl2">Proteksi</div>
      <div class="step-label" style="width:auto;flex:1;text-align:center;"></div>
      <div class="step-label" id="lbl3">Bunga</div>
      <div class="step-label" style="width:auto;flex:1;text-align:center;"></div>
      <div class="step-label" id="lbl4">Hasil</div>
    </div>
  </div>

  <!-- CONTENT -->
  <div class="content">

    <!-- STEP 1: NOMINAL -->
    <div class="screen active" id="screen-nominal">
      <div class="card">
        <div class="card-title" id="nominalTitle">üí∞ Harga Barang</div>
        <div class="nominal-display empty" id="nominalDisplay">Masukkan harga...</div>
        <div class="numpad">
          <button class="numpad-btn" onclick="numpadInput('1')">1</button>
          <button class="numpad-btn" onclick="numpadInput('2')">2</button>
          <button class="numpad-btn" onclick="numpadInput('3')">3</button>
          <button class="numpad-btn" onclick="numpadInput('4')">4</button>
          <button class="numpad-btn" onclick="numpadInput('5')">5</button>
          <button class="numpad-btn" onclick="numpadInput('6')">6</button>
          <button class="numpad-btn" onclick="numpadInput('7')">7</button>
          <button class="numpad-btn" onclick="numpadInput('8')">8</button>
          <button class="numpad-btn" onclick="numpadInput('9')">9</button>
          <button class="numpad-btn zero" onclick="numpadInput('0')">0</button>
          <button class="numpad-btn del" onclick="numpadDel()">‚å´</button>
          <button class="numpad-btn next-btn" onclick="goToProteksi()">Lanjut ‚Üí</button>
        </div>
      </div>
    </div>

    <!-- STEP 2: PROTEKSI YN + PILIH -->
    <div class="screen" id="screen-proteksi">
      <div class="card">
        <div class="card-title">üõ°Ô∏è Pakai Proteksi?</div>
        <div class="yn-grid" id="ynGrid">
          <div class="yn-btn" id="ynYes" onclick="setProteksiYN(true)">
            <div class="yn-icon">‚úÖ</div>
            <div class="yn-label">Pakai</div>
            <div class="yn-sub">Dengan proteksi</div>
          </div>
          <div class="yn-btn" id="ynNo" onclick="setProteksiYN(false)">
            <div class="yn-icon">‚ùå</div>
            <div class="yn-label">Tanpa</div>
            <div class="yn-sub">Skip proteksi</div>
          </div>
        </div>
      </div>

      <div id="proteksiList" style="display:none">
        <div class="card">
          <div class="card-title">‚òëÔ∏è Pilih Proteksi</div>
          <div class="info-chip">‚ÑπÔ∏è Boleh pilih lebih dari satu</div>
          <div class="toggle-grid" id="asuransiToggles">
            <div class="toggle-btn" id="t-AKUJAGA" onclick="toggleAsuransi('AKUJAGA')">
              <div class="toggle-check"></div>
              <div class="toggle-info">
                <div class="toggle-name">AMAN+</div>
                <div class="toggle-desc">Perlindungan jiwa peminjam</div>
              </div>
              <div class="toggle-price" id="price-AKUJAGA">‚Äì</div>
            </div>
            <div class="toggle-btn" id="t-GADGET" onclick="toggleAsuransi('GADGET')">
              <div class="toggle-check"></div>
              <div class="toggle-info">
                <div class="toggle-name">Santai</div>
                <div class="toggle-desc">Proteksi perangkat elektronik</div>
              </div>
              <div class="toggle-price" id="price-GADGET">‚Äì</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- STEP 3: BUNGA -->
    <div class="screen" id="screen-bunga">
      <div class="card">
        <div class="card-title">üìà Bunga per Bulan</div>
        <div class="bunga-grid">
          <div class="bunga-btn" onclick="selectBunga(0.0199)"><div class="bunga-rate">1.99%</div><div class="bunga-label">/ bulan</div></div>
          <div class="bunga-btn" onclick="selectBunga(0.0225)"><div class="bunga-rate">2.25%</div><div class="bunga-label">/ bulan</div></div>
          <div class="bunga-btn" onclick="selectBunga(0.0239)"><div class="bunga-rate">2.39%</div><div class="bunga-label">/ bulan</div></div>
          <div class="bunga-btn" onclick="selectBunga(0.0259)"><div class="bunga-rate">2.59%</div><div class="bunga-label">/ bulan</div></div>
          <div class="bunga-btn" onclick="selectBunga(0.0290)"><div class="bunga-rate">2.90%</div><div class="bunga-label">/ bulan</div></div>
          <div class="bunga-btn" onclick="selectBunga(0.0299)"><div class="bunga-rate">2.99%</div><div class="bunga-label">/ bulan</div></div>
          <div class="bunga-btn" onclick="selectBunga(0.0339)"><div class="bunga-rate">3.39%</div><div class="bunga-label">/ bulan</div></div>
          <div class="bunga-btn" onclick="selectBunga(0.0359)"><div class="bunga-rate">3.59%</div><div class="bunga-label">/ bulan</div></div>
          <div class="bunga-btn" onclick="selectBunga(0.0390)"><div class="bunga-rate">3.90%</div><div class="bunga-label">/ bulan</div></div>
        </div>
      </div>
    </div>

    <!-- STEP 4: RESULT -->
    <div class="screen" id="screen-result">
      <div id="resultContent"></div>
    </div>

  </div><!-- /content -->

  <!-- ACTION BAR -->
  <div class="action-bar" id="actionBar">
    <!-- Dynamic buttons injected by JS -->
  </div>

</div><!-- /app -->

<script>
/* ========== STATE ========== */
let state = {
  hargaBarang: '',
  cash: '',
  nominal: 0, // ini akan jadi pokok (hargaBarang - cash)
  asuransi: [],
  pakaProteksi: null,
  bunga: null
};

/* ========== STEP MANAGEMENT ========== */
let currentStep = 1;
let inputMode = 'harga'; // 'harga' atau 'cash'

function showScreen(n) {
  currentStep = n;
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  if (n === 1) {
    inputMode = 'harga';
    document.getElementById('screen-nominal').classList.add('active');
  } else if (n === 2) {
    inputMode = 'cash';
    document.getElementById('screen-nominal').classList.add('active');
  } else {
    document.getElementById(['','','','screen-proteksi','screen-bunga','screen-result'][n]).classList.add('active');
  }
  updateProgress(n);
  updateActionBar(n);
  window.scrollTo(0, 0);
}

function updateProgress(step) {
  // Map step ke progress dots (1=harga, 2=cash, 3=proteksi, 4=bunga, 5=hasil)
  // Tapi kita tetap tampilkan 4 dots: Harga+Cash, Proteksi, Bunga, Hasil
  let progressStep = step;
  if (step === 2) progressStep = 1; // cash tetap di step 1 visual
  if (step >= 3) progressStep = step - 1; // geser mundur 1 karena cash digabung
  
  for (let i = 1; i <= 4; i++) {
    const dot = document.getElementById('dot' + i);
    const lbl = document.getElementById('lbl' + i);
    dot.className = 'step-dot';
    if (lbl) lbl.className = 'step-label';
    if (i < progressStep) { 
      dot.classList.add('done'); 
      dot.innerHTML = ''; 
    }
    else if (i === progressStep) { 
      dot.classList.add('active'); 
      dot.innerHTML = '<span>' + i + '</span>'; 
      if(lbl) lbl.classList.add('active'); 
    }
    else dot.innerHTML = '<span>' + i + '</span>';
    if (i < 4) {
      const line = document.getElementById('line' + i);
      if (line) line.className = 'step-line' + (i < progressStep ? ' done' : '');
    }
  }
}

function updateActionBar(step) {
  const bar = document.getElementById('actionBar');
  if (step === 1) {
    bar.innerHTML = '';
    return;
  }
  if (step === 2) {
    bar.innerHTML = `
      <button class="btn btn-secondary" onclick="showScreen(1)">‚Üê</button>
      <button class="btn btn-primary" onclick="goToProteksi()">Lanjut ke Proteksi ‚Üí</button>`;
    return;
  }
  if (step === 3) {
    bar.innerHTML = `
      <button class="btn btn-secondary" onclick="showScreen(2)">‚Üê</button>
      <button class="btn btn-primary" onclick="goToBunga()">Lanjut ke Bunga ‚Üí</button>`;
    updateActionBarStep3();
    return;
  }
  if (step === 4) {
    bar.innerHTML = `
      <button class="btn btn-secondary" onclick="showScreen(3)">‚Üê</button>
      <div style="flex:1;display:flex;align-items:center;justify-content:center;color:var(--muted);font-size:13px;">Pilih bunga di atas</div>`;
    return;
  }
  if (step === 5) {
    bar.innerHTML = `
      <button class="btn btn-ghost" onclick="showScreen(4)" style="flex:0 0 auto;padding:0 14px;">Bunga</button>
      <button class="btn btn-ghost" onclick="showScreen(3)" style="flex:0 0 auto;padding:0 14px;">Proteksi</button>
      <button class="btn btn-primary" onclick="resetAll()">üîÑ Hitung Ulang</button>`;
    return;
  }
}

/* ========== NUMPAD ========== */
function numpadInput(d) {
  if (inputMode === 'harga') {
    if (state.hargaBarang.length >= 12) return;
    state.hargaBarang += d;
  } else if (inputMode === 'cash') {
    if (state.cash.length >= 12) return;
    state.cash += d;
  }
  renderNominal();
}
function numpadDel() {
  if (inputMode === 'harga') {
    state.hargaBarang = state.hargaBarang.slice(0, -1);
  } else if (inputMode === 'cash') {
    state.cash = state.cash.slice(0, -1);
  }
  renderNominal();
}
function renderNominal() {
  const el = document.getElementById('nominalDisplay');
  const titleEl = document.getElementById('nominalTitle');
  
  if (inputMode === 'harga') {
    titleEl.textContent = 'üí∞ Harga Barang';
    if (!state.hargaBarang) {
      el.textContent = 'Masukkan harga...';
      el.className = 'nominal-display empty';
    } else {
      el.textContent = 'Rp ' + parseInt(state.hargaBarang).toLocaleString('id-ID');
      el.className = 'nominal-display';
    }
  } else if (inputMode === 'cash') {
    titleEl.textContent = 'üíµ Uang Muka (Cash)';
    if (!state.cash) {
      el.textContent = 'Masukkan cash...';
      el.className = 'nominal-display empty';
    } else {
      el.textContent = 'Rp ' + parseInt(state.cash).toLocaleString('id-ID');
      el.className = 'nominal-display';
    }
  }
}
function goToProteksi() {
  if (inputMode === 'harga') {
    if (!state.hargaBarang || parseInt(state.hargaBarang) < 100000) {
      shake(document.getElementById('nominalDisplay'));
      return;
    }
    // Lanjut ke input cash
    showScreen(2);
    renderNominal();
  } else if (inputMode === 'cash') {
    const harga = parseInt(state.hargaBarang) || 0;
    const cash = parseInt(state.cash) || 0;
    if (cash >= harga) {
      alert('Cash tidak boleh lebih besar atau sama dengan harga barang!');
      return;
    }
    // Hitung pokok
    state.nominal = harga - cash;
    updateAkujagaPrice();
    updateGadgetPrice();
    showScreen(3);
  }
}
function shake(el) {
  el.style.animation = 'none';
  el.offsetHeight;
  el.style.animation = 'shake 0.4s ease';
  setTimeout(() => el.style.animation = '', 400);
}

/* ========== PROTEKSI ========== */
function setProteksiYN(yn) {
  state.pakaProteksi = yn;
  if (yn) {
    document.getElementById('ynYes').className = 'yn-btn yn-yes';
    document.getElementById('ynNo').className = 'yn-btn';
    document.getElementById('proteksiList').style.display = 'block';
    updateActionBarStep3();
  } else {
    document.getElementById('ynNo').className = 'yn-btn yn-no';
    document.getElementById('ynYes').className = 'yn-btn';
    document.getElementById('proteksiList').style.display = 'none';
    state.asuransi = [];
    // Langsung lanjut ke bunga jika pilih tanpa proteksi
    setTimeout(() => showScreen(4), 250);
  }
}

function toggleAsuransi(key) {
  const idx = state.asuransi.indexOf(key);
  if (idx >= 0) state.asuransi.splice(idx, 1);
  else state.asuransi.push(key);
  renderToggles();
}

function renderToggles() {
  ['AKUJAGA', 'GADGET'].forEach(k => {
    const el = document.getElementById('t-' + k);
    if (!el) return;
    el.classList.toggle('selected', state.asuransi.includes(k));
  });
}

function updateAkujagaPrice() {
  const nominal = state.nominal || 0;
  const perBulan = nominal * 0.0099;
  const el = document.getElementById('price-AKUJAGA');
  if (el) el.textContent = rupiah(perBulan) + '/bln';
}
function updateGadgetPrice() {
  const hargaBarang = parseInt(state.hargaBarang) || 0;
  const premi = hargaBarang > 10000000 ? 899000 : 599000;
  const el = document.getElementById('price-GADGET');
  if (el) el.textContent = rupiah(premi);
}

function updateActionBarStep3() {
  if (currentStep !== 3) return;
  const bar = document.getElementById('actionBar');
  const lanjutBtn = bar.querySelector('.btn-primary');
  if (!lanjutBtn) return;
  // Tampilkan tombol lanjut hanya jika pilih pakai proteksi
  if (state.pakaProteksi === true) {
    lanjutBtn.style.display = 'flex';
  } else {
    lanjutBtn.style.display = 'none';
  }
}

function goToBunga() {
  showScreen(4);
}

/* ========== BUNGA ========== */
function selectBunga(rate) {
  state.bunga = rate;
  document.querySelectorAll('.bunga-btn').forEach(b => b.classList.remove('selected'));
  event.currentTarget.classList.add('selected');
  setTimeout(() => {
    buildAndShowResult();
    showScreen(5);
  }, 200);
}

/* ========== RESULT ========== */
function buildAndShowResult() {
  const el = document.getElementById('resultContent');
  el.innerHTML = buildResultHTML();
}

function buildResultHTML() {
  const pokok = state.nominal; // sudah dalam bentuk integer (harga - cash)
  const bunga = state.bunga;
  const as = state.asuransi;
  const hargaBarang = parseInt(state.hargaBarang) || 0;

  let totalAsuransi = 0;
  let akujagaPerBulan = 0;
  let proteksiRows = [];

  if (as.includes('AKUJAGA')) {
    akujagaPerBulan = pokok * 0.0099;
    proteksiRows.push({ name: 'AMAN+', val: rupiah(akujagaPerBulan) + '/bln' });
  }
  if (as.includes('GADGET')) {
    const premi = hargaBarang > 10000000 ? 899000 : 599000;
    totalAsuransi += premi;
    proteksiRows.push({ name: 'Santai', val: rupiah(premi) });
  }

  // Summary header
  let html = `<div class="result-header fade">
    <div class="result-header-row">
      <div class="result-label">Harga Barang</div>
      <div class="result-value">${rupiah(parseInt(state.hargaBarang))}</div>
    </div>
    <div class="result-header-row">
      <div class="result-label">Uang Muka (Cash)</div>
      <div class="result-value">${rupiah(parseInt(state.cash) || 0)}</div>
    </div>
    <div class="sep" style="margin:10px 0"></div>
    <div class="result-header-row">
      <div class="result-label">Nominal Pokok</div>
      <div class="result-value big">${rupiah(pokok)}</div>
    </div>
    <div class="sep" style="margin:10px 0"></div>
    <div class="result-header-row">
      <div class="result-label">Bunga / Bulan</div>
      <div class="result-value">${(bunga * 100).toFixed(2)}%</div>
    </div>
    <div class="result-header-row">
      <div class="result-label">Proteksi</div>
      <div>`;

  if (proteksiRows.length === 0) {
    html += `<span style="font-size:12px;color:var(--muted)">Tidak ada</span>`;
  } else {
    html += `<div class="proteksi-tags">` + proteksiRows.map(r =>
      `<div class="ptag-wrap">
        <span class="ptag">${r.name}</span>
        <span class="ptag-price">${r.val}</span>
      </div>`).join('') + `</div>`;
  }
  html += `</div></div></div>`;

  // Tenor 3, 6, 9, 12, 15, 18, 24
  [3, 6, 9, 12, 15, 18, 24].forEach(tenor => {
    html += buildTenorCard(tenor, pokok, bunga, akujagaPerBulan, totalAsuransi);
  });

  return html;
}

function buildTenorCard(tenor, pokok, bunga, akujagaPerBulan, totalAsuransi) {
  const cardId = 'tenor-body-' + tenor;
  const iconId = 'tenor-icon-' + tenor;

  // ===== Kalkulasi =====
  const ta = totalAsuransi + akujagaPerBulan * tenor;
  const base = pokok + ta;
  const bungaTotal = base * bunga * tenor;
  const total = base + bungaTotal;
  const cicilan = total / tenor;

  const stdLabel = 'Cicilan per Bulan';
  const stdHTML = `<div class="option-row" style="border:none;padding:12px 0">
    <div class="option-cicilan">${rupiah(cicilan)}<span style="font-size:13px;color:var(--muted);font-family:var(--font)">/bln</span></div>
    <div class="option-total">Total Pembayaran: ${rupiah(total)}</div>
    <div class="calc-desc">
      (Pokok + Proteksi) √ó bunga ${(bunga*100).toFixed(2)}% √ó ${tenor} bulan<br>
      Total √∑ ${tenor} = <code>${rupiah(cicilan)}/bln</code>
    </div>
  </div>`;

  let html = `<div class="tenor-card fade">
    <div class="tenor-header" onclick="toggleTenor(${tenor})">
      <div class="tenor-badge">${tenor} BLN</div>
      <div class="tenor-title">Tenor ${tenor} Bulan</div>
      <div class="tenor-toggle-icon" id="${iconId}">‚ñº</div>
    </div>
    <div class="tenor-body" id="${cardId}">
      ${stdHTML}
    </div>
  </div>`;

  return html;
}

/* ========== TENOR TOGGLE ========== */
function toggleTenor(tenor) {
  const body = document.getElementById('tenor-body-' + tenor);
  const icon = document.getElementById('tenor-icon-' + tenor);
  if (!body) return;
  const isOpen = body.classList.contains('open');
  body.classList.toggle('open', !isOpen);
  icon.classList.toggle('open', !isOpen);
}

/* ========== RESET ========== */
function resetAll() {
  state = { hargaBarang: '', cash: '', nominal: 0, asuransi: [], pakaProteksi: null, bunga: null };
  inputMode = 'harga';
  document.getElementById('nominalDisplay').textContent = 'Masukkan harga...';
  document.getElementById('nominalDisplay').className = 'nominal-display empty';
  document.getElementById('nominalTitle').textContent = 'üí∞ Harga Barang';
  document.getElementById('proteksiList').style.display = 'none';
  document.getElementById('ynYes').className = 'yn-btn';
  document.getElementById('ynNo').className = 'yn-btn';
  renderToggles();
  document.querySelectorAll('.bunga-btn').forEach(b => b.classList.remove('selected'));
  showScreen(1);
}

/* ========== UTIL ========== */
function rupiah(n) {
  return 'Rp ' + Math.round(n).toLocaleString('id-ID');
}

// Shake animation
const style = document.createElement('style');
style.textContent = `@keyframes shake { 0%,100%{transform:translateX(0)} 20%{transform:translateX(-8px)} 40%{transform:translateX(8px)} 60%{transform:translateX(-5px)} 80%{transform:translateX(5px)} }`;
document.head.appendChild(style);

// Init
updateProgress(1);
updateActionBar(1);
</script>
</body>
</html>
